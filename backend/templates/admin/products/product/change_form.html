
{% extends "admin/change_form.html" %}
{% load i18n static %}

{% block extrahead %}{{ block.super }}
<script src="{% static 'js/product_form.js' %}"></script>
{% endblock %}

{% block extrastyle %}{{ block.super }}
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<style>
body {
    font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

/* Main form container */
.form-container {
    background: #fff;
    border-radius: 0.5rem;
    box-shadow: 0 0.2rem 0.5rem rgba(0, 0, 0, 0.05);
    padding: 1.5rem;
    margin-bottom: 1.5rem;
}

.form-container h2 {
    color: #4c6ef5;
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid #e9ecef;
}

.form-container h2 i {
    margin-left: 0.5rem;
    color: #4c6ef5;
}

.form-row {
    margin-bottom: 1rem;
}

.form-row label {
    font-weight: 500;
    color: #495057;
    margin-bottom: 0.5rem;
    display: block;
}

.form-row input,
.form-row select,
.form-row textarea {
    width: 100%;
    padding: 0.5rem 0.75rem;
    border: 1px solid #ced4da;
    border-radius: 0.25rem;
    font-size: 1rem;
    transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
}

.form-row input[type="checkbox"] {
    width: auto;
}

.form-row input:focus,
.form-row select:focus,
.form-row textarea:focus {
    border-color: #4c6ef5;
    box-shadow: 0 0 0 0.2rem rgba(76, 110, 245, 0.25);
    outline: none;
}

.form-row textarea {
    min-height: 100px;
    resize: vertical;
}

/* Tab navigation */
.tab-nav {
    display: flex;
    flex-wrap: wrap;
    margin-bottom: 1.5rem;
    border-bottom: 1px solid #e9ecef;
    background: #f8f9fa;
    padding: 0.5rem;
    border-radius: 0.5rem;
}

.tab-nav-item {
    padding: 0.75rem 1.25rem;
    cursor: pointer;
    background: none;
    border: none;
    font-size: 0.95rem;
    font-weight: 500;
    color: #6c757d;
    position: relative;
    transition: all 0.2s ease;
    border-radius: 0.25rem;
    margin-right: 0.25rem;
}

.tab-nav-item:hover {
    background: rgba(76, 110, 245, 0.05);
    color: #4c6ef5;
}

.tab-nav-item.active {
    background: #4c6ef5;
    color: white;
}

.tab-nav-item i {
    margin-left: 0.5rem;
}

/* Tab content */
.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
    animation: fadeIn 0.2s ease-in-out;
}

/* Manual Tab Navigation */
.tab-navigation-buttons {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 1rem 0;
    padding: 0.75rem;
    background: #f8f9fa;
    border-radius: 0.25rem;
}

.tab-nav-btn {
    display: flex;
    align-items: center;
    padding: 0.5rem 1rem;
    background: #4c6ef5;
    color: white;
    border: none;
    border-radius: 0.25rem;
    cursor: pointer;
    font-weight: 500;
    transition: background 0.2s ease;
}

.tab-nav-btn:hover {
    background: #364fc7;
}

.tab-nav-btn:disabled {
    background: #adb5bd;
    cursor: not-allowed;
}

.tab-nav-btn i {
    margin: 0 0.5rem;
}

.tab-indicator {
    font-weight: 600;
    color: #495057;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(5px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Buttons */
.submit-row {
    padding: 1.5rem 0;
    display: flex;
    justify-content: flex-end;
    gap: 1rem;
    border-top: 1px solid #e9ecef;
    margin-top: 1.5rem;
}

.button, .submit-row input {
    padding: 0.6rem 1.5rem;
    border-radius: 0.25rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    border: none;
    font-size: 0.95rem;
}

.button.default, .submit-row input[type="submit"] {
    background: #4c6ef5;
    color: white;
}

.button.default:hover, .submit-row input[type="submit"]:hover {
    background: #364fc7;
}

.button {
    background: #e9ecef;
    color: #495057;
}

.button:hover {
    background: #dee2e6;
}

/* Checkbox and radio */
input[type="checkbox"], input[type="radio"] {
    margin-left: 0.5rem;
    width: 1.1rem;
    height: 1.1rem;
    cursor: pointer;
}

/* Responsive */
@media (max-width: 768px) {
    .tab-nav {
        flex-direction: row;
        overflow-x: auto;
        white-space: nowrap;
    }
    
    .tab-nav-item {
        padding: 0.5rem 1rem;
        font-size: 0.85rem;
    }
}
</style>
{% endblock %}

{% block content %}
<div id="content-main">
    <form action="{{ form_url }}" method="post" id="{{ opts.model_name }}_form" enctype="multipart/form-data">
        {% csrf_token %}{% form_top %}

        <!-- Tab Navigation -->
        <div class="tab-nav">
            <button type="button" class="tab-nav-item active" data-tab="basic-info" onclick="switchToTab('basic-info')">
                <i class="fas fa-info-circle"></i> معلومات أساسية
            </button>
            <button type="button" class="tab-nav-item" data-tab="pricing" onclick="switchToTab('pricing')">
                <i class="fas fa-money-bill-wave"></i> التسعير والخصومات
            </button>
            <button type="button" class="tab-nav-item" data-tab="inventory" onclick="switchToTab('inventory')">
                <i class="fas fa-boxes"></i> إدارة المخزون
            </button>
            <button type="button" class="tab-nav-item" data-tab="gallery" onclick="switchToTab('gallery')">
                <i class="fas fa-images"></i> معرض الصور
            </button>
            <button type="button" class="tab-nav-item" data-tab="details" onclick="switchToTab('details')">
                <i class="fas fa-tag"></i> تفاصيل المنتج
            </button>
            <button type="button" class="tab-nav-item" data-tab="seo" onclick="switchToTab('seo')">
                <i class="fas fa-search"></i> SEO والبيانات الوصفية
            </button>
            <button type="button" class="tab-nav-item" data-tab="features" onclick="switchToTab('features')">
                <i class="fas fa-star"></i> الحالة والمميزات
            </button>
        </div>

        <!-- Manual Tab Navigation -->
        <div class="tab-navigation-buttons">
            <button type="button" class="tab-nav-btn prev-btn" onclick="navigateTab('prev')">
                <i class="fas fa-chevron-right"></i> السابق
            </button>
            <div class="tab-indicator">
                <span class="current-tab">1</span> / <span class="total-tabs">7</span>
            </div>
            <button type="button" class="tab-nav-btn next-btn" onclick="navigateTab('next')">
                التالي <i class="fas fa-chevron-left"></i>
            </button>
        </div>

        <!-- Tab Content -->
        <div class="tab-content active" id="basic-info">
            <div class="form-container">
                <h2><i class="fas fa-info-circle"></i> معلومات أساسية</h2>

                <div class="form-row">
                    <label for="{{ form.name.id_for_label }}">اسم المنتج *</label>
                    {{ form.name }}
                </div>

                <div class="form-row">
                    <label for="{{ form.description.id_for_label }}">الوصف *</label>
                    {{ form.description }}
                </div>

                <div class="form-row">
                    <label for="{{ form.category.id_for_label }}">القسم *</label>
                    {{ form.category }}
                </div>

                <div class="form-row">
                    <label for="{{ form.brand.id_for_label }}">الماركة</label>
                    {{ form.brand }}
                </div>

                <div class="form-row">
                    <label for="{{ form.model.id_for_label }}">الطراز</label>
                    {{ form.model }}
                </div>
            </div>
        </div>

        <div class="tab-content" id="pricing">
            <div class="form-container">
                <h2><i class="fas fa-money-bill-wave"></i> التسعير والخصومات</h2>

                <div class="form-row">
                    <label for="{{ form.price.id_for_label }}">السعر الأصلي</label>
                    {{ form.price }}
                </div>

                <div class="form-row">
                    <label for="{{ form.discount_price.id_for_label }}">السعر بعد الخصم</label>
                    {{ form.discount_price }}
                </div>

                <div class="form-row">
                    <label for="{{ form.discount_amount.id_for_label }}">مبلغ الخصم (د.ع)</label>
                    {{ form.discount_amount }}
                </div>

                <div class="form-row">
                    <label for="{{ form.discount_start.id_for_label }}">تاريخ بدء الخصم</label>
                    {{ form.discount_start }}
                </div>

                <div class="form-row">
                    <label for="{{ form.discount_end.id_for_label }}">تاريخ انتهاء الخصم</label>
                    {{ form.discount_end }}
                </div>
            </div>
        </div>

        <div class="tab-content" id="inventory">
            <div class="form-container">
                <h2><i class="fas fa-boxes"></i> إدارة المخزون</h2>

                <div class="form-row">
                    <label for="{{ form.stock_quantity.id_for_label }}">الكمية المتوفرة</label>
                    {{ form.stock_quantity }}
                </div>

                <div class="form-row">
                    <label for="{{ form.low_stock_threshold.id_for_label }}">حد التنبيه للمخزون</label>
                    {{ form.low_stock_threshold }}
                </div>
            </div>
        </div>

        <div class="tab-content" id="gallery">
            <div class="form-container">
                <h2><i class="fas fa-images"></i> معرض الصور</h2>

                <div class="form-row">
                    <label for="{{ form.main_image.id_for_label }}">الصورة الرئيسية (رابط ImgBB)</label>
                    {{ form.main_image }}
                </div>

                <div class="form-row">
                    <label for="{{ form.image_2.id_for_label }}">الصورة الثانية (رابط ImgBB)</label>
                    {{ form.image_2 }}
                </div>

                <div class="form-row">
                    <label for="{{ form.image_3.id_for_label }}">الصورة الثالثة (رابط ImgBB)</label>
                    {{ form.image_3 }}
                </div>

                <div class="form-row">
                    <label for="{{ form.image_4.id_for_label }}">الصورة الرابعة (رابط ImgBB)</label>
                    {{ form.image_4 }}
                </div>
            </div>
        </div>

        <div class="tab-content" id="details">
            <div class="form-container">
                <h2><i class="fas fa-tag"></i> تفاصيل المنتج</h2>

                <div class="form-row">
                    <label for="{{ form.color.id_for_label }}">اللون</label>
                    {{ form.color }}
                </div>

                <div class="form-row">
                    <label for="{{ form.size.id_for_label }}">المقاس</label>
                    {{ form.size }}
                </div>

                <div class="form-row">
                    <label for="{{ form.weight.id_for_label }}">الوزن (كجم)</label>
                    {{ form.weight }}
                </div>
            </div>
        </div>

        <div class="tab-content" id="seo">
            <div class="form-container">
                <h2><i class="fas fa-search"></i> SEO والبيانات الوصفية</h2>

                <div class="form-row">
                    <label for="{{ form.slug.id_for_label }}">الرابط (Slug)</label>
                    {{ form.slug }}
                </div>

                <div class="form-row">
                    <label for="{{ form.meta_description.id_for_label }}">وصف SEO</label>
                    {{ form.meta_description }}
                </div>

                <div class="form-row">
                    <label for="{{ form.tags.id_for_label }}">الكلمات المفتاحية</label>
                    {{ form.tags }}
                </div>
            </div>
        </div>

        <div class="tab-content" id="features">
            <div class="form-container">
                <h2><i class="fas fa-star"></i> الحالة والمميزات</h2>

                <div class="form-row">
                    <label for="{{ form.is_active.id_for_label }}">نشط</label>
                    {{ form.is_active }}
                </div>

                <div class="form-row">
                    <label for="{{ form.is_featured.id_for_label }}">منتج مميز</label>
                    {{ form.is_featured }}
                </div>

                <div class="form-row">
                    <label for="{{ form.show_on_homepage.id_for_label }}">إظهار في الواجهة الرئيسية</label>
                    {{ form.show_on_homepage }}
                </div>

                <div class="form-row">
                    <label for="{{ form.display_order.id_for_label }}">ترتيب العرض</label>
                    {{ form.display_order }}
                </div>
            </div>
        </div>

        <div class="submit-row">
            <input type="submit" value="{% trans 'Save and add another' %}" name="_addanother">
            <input type="submit" value="{% trans 'Save and continue editing' %}" name="_continue">
            <input type="submit" value="{% trans 'Save' %}" class="default" name="_save">
        </div>
    </form>
</div>
{% endblock %}
